# –ê–Ω–∞–ª–∏–∑ —Å–∏—Å—Ç–µ–º—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —á–∞—Ç–æ–≤ –º–µ–∂–¥—É –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º–∏

## üìä –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è: **–ù–ï–¢ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è**

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–µ–π—á–∞—Å:

1. **–í—Å–µ –¥–∏–∞–ª–æ–≥–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ–º** - –ª—é–±–æ–π –º–µ–Ω–µ–¥–∂–µ—Ä –∏–ª–∏ –≤–ª–∞–¥–µ–ª–µ—Ü –º–∞–≥–∞–∑–∏–Ω–∞ –≤–∏–¥–∏—Ç –í–°–ï –¥–∏–∞–ª–æ–≥–∏
2. **–ù–µ—Ç –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è** - –¥–∏–∞–ª–æ–≥–∏ –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º
3. **–û–±—â–∏–π –ø—É–ª** - –≤—Å–µ —Ä–∞–±–æ—Ç–∞—é—Ç —Å –æ–¥–Ω–∏–º —Å–ø–∏—Å–∫–æ–º –¥–∏–∞–ª–æ–≥–æ–≤

### –¢–µ–∫—É—â–∞—è –º–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö:

```prisma
model Dialog {
  id              String
  shopId          String    // –ü—Ä–∏–≤—è–∑–∫–∞ –∫ –º–∞–≥–∞–∑–∏–Ω—É
  // –ù–ï–¢ –ø–æ–ª—è managerId –∏–ª–∏ assignedTo
  ...
}
```

### –õ–æ–≥–∏–∫–∞ –¥–æ—Å—Ç—É–ø–∞:
```typescript
// backend/src/routes/dialog.routes.ts
const shopId = user?.ownedShop?.id || user?.managedShop?.id;
// –ü–æ–ª—É—á–∞–µ–º –í–°–ï –¥–∏–∞–ª–æ–≥–∏ –º–∞–≥–∞–∑–∏–Ω–∞
const dialogs = await prisma.dialog.findMany({
  where: { shopId }
});
```

## ‚ùå –ü—Ä–æ–±–ª–µ–º—ã —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:

1. **–•–∞–æ—Å –ø—Ä–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ–Ω–µ–¥–∂–µ—Ä–∞—Ö** - –≤—Å–µ –æ—Ç–≤–µ—á–∞—é—Ç –≤—Å–µ–º
2. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã** - –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –º–æ–≥—É—Ç –æ—Ç–≤–µ—á–∞—Ç—å –æ–¥–Ω–æ–º—É –∫–ª–∏–µ–Ω—Ç—É
3. **–ù–µ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏** - –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ –∫—Ç–æ –∑–∞ —á—Ç–æ –æ—Ç–≤–µ—á–∞–µ—Ç
4. **–ù–µ—Ç –º–µ—Ç—Ä–∏–∫** - –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å —Ä–∞–±–æ—Ç—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞

## üí° –í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è:

### –í–∞—Ä–∏–∞–Ω—Ç 1: –†—É—á–Ω–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ
- –í–ª–∞–¥–µ–ª–µ—Ü/—Å—Ç–∞—Ä—à–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–∞–∑–Ω–∞—á–∞–µ—Ç –¥–∏–∞–ª–æ–≥–∏
- –ú–µ–Ω–µ–¥–∂–µ—Ä –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–∏–∞–ª–æ–≥–∏
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏ –¥—Ä—É–≥–æ–º—É –º–µ–Ω–µ–¥–∂–µ—Ä—É

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
- Round-robin (–ø–æ –æ—á–µ—Ä–µ–¥–∏)
- –ü–æ –∑–∞–≥—Ä—É–∑–∫–µ (—É –∫–æ–≥–æ –º–µ–Ω—å—à–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö)
- –ü–æ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã (–∫—Ç–æ –æ–Ω–ª–∞–π–Ω)
- –ü–æ –Ω–∞–≤—ã–∫–∞–º/—Ç–µ–≥–∞–º

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ó–∞—Ö–≤–∞—Ç –¥–∏–∞–ª–æ–≥–∞
- –í—Å–µ –≤–∏–¥—è—Ç –Ω–æ–≤—ã–µ –¥–∏–∞–ª–æ–≥–∏
- –ü–µ—Ä–≤—ã–π –æ—Ç–≤–µ—Ç–∏–≤—à–∏–π "–∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç" –¥–∏–∞–ª–æ–≥
- –û—Å—Ç–∞–ª—å–Ω—ã–µ –≤–∏–¥—è—Ç, —á—Ç–æ –¥–∏–∞–ª–æ–≥ –∑–∞–Ω—è—Ç

### –í–∞—Ä–∏–∞–Ω—Ç 4: –ì–∏–±—Ä–∏–¥–Ω—ã–π
- –ù–æ–≤—ã–µ –¥–∏–∞–ª–æ–≥–∏ –≤ –æ–±—â–µ–º –ø—É–ª–µ
- –ú–µ–Ω–µ–¥–∂–µ—Ä –±–µ—Ä–µ—Ç –¥–∏–∞–ª–æ–≥ —Å–µ–±–µ
- –ê–≤—Ç–æ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ–æ—Ç–≤–µ—á–µ–Ω–Ω—ã—Ö

## üîß –ß—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

### 1. –û–±–Ω–æ–≤–∏—Ç—å —Å—Ö–µ–º—É –ë–î:
```prisma
model Dialog {
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è
  assignedToId  String?
  assignedTo    User?     @relation(fields: [assignedToId], references: [id])
  assignedAt    DateTime?
}
```

### 2. –î–æ–±–∞–≤–∏—Ç—å API endpoints:
- `POST /dialogs/:id/assign` - –Ω–∞–∑–Ω–∞—á–∏—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä–∞
- `POST /dialogs/:id/claim` - –≤–∑—è—Ç—å –¥–∏–∞–ª–æ–≥ —Å–µ–±–µ
- `POST /dialogs/:id/release` - –æ—Å–≤–æ–±–æ–¥–∏—Ç—å –¥–∏–∞–ª–æ–≥

### 3. –û–±–Ω–æ–≤–∏—Ç—å UI:
- –§–∏–ª—å—Ç—Ä "–ú–æ–∏ –¥–∏–∞–ª–æ–≥–∏" / "–í—Å–µ –¥–∏–∞–ª–æ–≥–∏"
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞
- –ö–Ω–æ–ø–∫–∏ "–í–∑—è—Ç—å —Å–µ–±–µ" / "–ü–µ—Ä–µ–¥–∞—Ç—å"

### 4. –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É:
- –ê–≤—Ç–æ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏
- –ü–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏ —É—Ö–æ–¥–µ –º–µ–Ω–µ–¥–∂–µ—Ä–∞

## üìà –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:

–ù–∞—á–∞—Ç—å —Å **–í–∞—Ä–∏–∞–Ω—Ç–∞ 3 (–ó–∞—Ö–≤–∞—Ç –¥–∏–∞–ª–æ–≥–∞)**:
- –ü—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
- –ì–∏–±–∫–æ—Å—Ç—å –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
- –ò–∑–±–µ–≥–∞–µ–º –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é –ø–æ–∑–∂–µ

–≠—Ç–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ —Ä–µ—à–∏—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã.